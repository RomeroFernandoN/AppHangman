CREATE DATABASE HANGMAN

CREATE TABLE USERS(
ID_USER INT IDENTITY(1,1),
NAME VARCHAR(30),
SURNAME VARCHAR(30),
EMAIL VARCHAR(50),
BIRTHDATE DATETIME,
PUNCTUATION INT,
COUNTRY VARCHAR(50)
CONSTRAINT PK_USERS PRIMARY KEY(ID_USER)
)

--STORED PROCEDURES
CREATE PROCEDURE SP_INSERT_USER
@NAME VARCHAR(30),
@SURNAME VARCHAR(30),
@EMAIL VARCHAR(50),
@BIRTHDATE DATETIME,
@PUNCTUATION INT,
@COUNTRY VARCHAR(50)
AS
BEGIN
IF(@EMAIL NOT IN (SELECT EMAIL FROM USERS))
	BEGIN
	SET DATEFORMAT DMY
	INSERT INTO USERS
	VALUES (@NAME, @SURNAME, @EMAIL, @BIRTHDATE, @PUNCTUATION, @COUNTRY)
	END
END

CREATE PROCEDURE SP_LOGIN
@EMAIL VARCHAR(50),
@AUX INT OUTPUT
AS
BEGIN
IF(@EMAIL IN (SELECT EMAIL FROM USERS))
	BEGIN
	SET @AUX = 1
	END
ELSE
	BEGIN
	SET @AUX = 0
	END
END

CREATE PROCEDURE SP_PUNCTUATION
@EMAIL VARCHAR(50),
@PUNCTUATION INT
AS
BEGIN
UPDATE USERS
SET PUNCTUATION = PUNCTUATION + @PUNCTUATION
WHERE EMAIL = @EMAIL
END

CREATE PROCEDURE SP_BEST_SCORES
AS
BEGIN
SELECT UPPER(SURNAME) + ', ' + UPPER(NAME) AS NAME, 
       PUNCTUATION PUNCTUATION,
       COUNTRY COUNTRY
FROM USERS
ORDER BY 2 DESC
END

SET DATEFORMAT dmy
EXEC SP_INSERT_USER 'FERNANDO','ROMERO','romerofernandonicolas@gmail.com','02/08/1996',0,'ARGENTINA'
SELECT *FROM USERS

declare @Aux int
EXEC SP_LOGIN 'romerofernandonicolas@gmail.com', @Aux OUTPUT
SELECT @Aux

EXEC SP_PUNCTUATION 'romerofernandonicolas@gmail.com',100